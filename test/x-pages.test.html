<!doctype html>
<html lang="en">

<head>
  
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes">

  <title>x-pages test</title>

  <script src="../../webcomponentsjs/webcomponents-lite.js"></script>
  <script src="../../web-component-tester/browser.js"></script>

  <link rel="import" href="../x-pages.html">

</head>

<body>

  <test-fixture id="element">
    
    <template>
      <x-pages>
        <div id="1" pattern="^1$"></div>
        <div id="2" pattern="^2$"></div>
        <div id="2-3" pattern="^2|3$"></div>
      </x-pages>
    </template>

  </test-fixture>

  <script>

      suite('x-pages', function () {

        let element;
        setup(function () {
          element = fixture('element');
        })

        test('instantiating the element works', function () {
          assert.equal(element.is, 'x-pages');
        });

        test('selecting first element works', function () {
          element.selected = '1';
          assert.equal(element.currentElements[0].id, '1');
        });

        test('selecting second element works', function () {
          element.selected = '2';
          assert.equal(element.currentElements[0].id, '2');
        });

        test('selecting third element works', function () {
          element.selected = '3';
          assert.equal(element.currentElements[0].id, '2-3');
        });

        test('selecting multiple element works', function () {
          element.selected = '2';
          assert.equal(element.currentElements[1].id, '2-3');
        });

        test('activate childs works', function () {
          var div1 = document.createElement('div');
          var div2 = document.createElement('div');
          element._activateChilds([div1, div2]);
          assert.equal(div1.hasAttribute(`visible`), true);
          assert.equal(div2.hasAttribute(`visible`), true);
        });

        test('deactivate childs works', function () {
          var div1 = document.createElement('div');
          div1.setAttribute('visible', '');
          var div2 = document.createElement('div');
          div2.setAttribute('visible', '');
          element._deactivateChilds([div1, div2]);
          assert.equal(div1.hasAttribute(`visible`), false);
          assert.equal(div2.hasAttribute(`visible`), false);
        });

        test('page change event works', function (next) {
          element.selected = '1';
          element.addEventListener("page-change", function(event) {
            event.preventDefault = true;
            assert.equal(event.detail.current, '2');
            assert.equal(event.detail.previous, '1');
            next();
          })
          element.selected = '2';
        });

        test('find elements works', function () {
          let newValue = '1';
          let oldValue = '2';
          let foundElement = element._findElements(newValue, oldValue);
          assert.equal(foundElement.previous[0].id, '2');
          assert.equal(foundElement.current[0].id, '1');
        });

      });

    </script>

</body>

</html>